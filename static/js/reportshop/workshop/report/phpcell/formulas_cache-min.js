function TCRSFormulas(i,j,k,o,l,m,p,n){this.s_label=i;this.s_formulas_type=j;this.s_workflow_time=k;this.s_app_time=o;this.s_distinct=l;this.s_recursive=m;this.s_fun_name=p;this.s_fetch_end=n;this.arr_cur_table_ref=null;this.arr_cur_column_ref=null;this.arr_column_ref_back=null;this.arr_column_ref=null;this.arr_fill_expr=null;this.s_sql="";this.s_sql2="";this.b_merged=false;this.b_hasif=false;this.b_has_match=false;this.b_parsed=false;this.b_to_executed=false;this.i_fill_step=7;this.i_cur_seq=0;this.b_do_match=false;this.i_match_value_fill_formulas_index=-1;this.s_cond_sql="";this.s_db_name="";this.s_table_list="";this.s_table_link="";this.s_condition_expr="";this.s_compute_expr="";this.s_target_expr="";this.s_order_expr="";this.s_fill_table="";this.s_fill_expr="";this.s_v_compute_expr="";this.s_dump_sql="";this.s_recursive_cond_expr="";this.s_recursive_expr="";this.s_column_ref_back="";this.arr_merged_formulas_index=null}TCRSFormulas.prototype={constructor:TCRSFormulas,Init:function(n,o,k,p,m,l,j,i){this.s_table_list=n;this.s_table_link=o;this.s_condition_expr=k;this.s_compute_expr=p;this.s_target_expr=m;this.s_order_expr=l;this.s_fill_table=j;this.s_fill_expr=i},set_to_executed:function(n){if(this.b_to_executed==n){return}this.b_to_executed=n;if(this.arr_fill_expr==null){return}if(this.b_to_executed){for(var l=0,i=this.arr_fill_expr.length/this.i_fill_step;l<i;l++){if(this.arr_fill_expr[l*this.i_fill_step+5]=="\u586b\u5165\u503c"){var f=this.arr_fill_expr[l*this.i_fill_step+3];var m=this.arr_fill_expr[l*this.i_fill_step+4];for(var o=0,p=crsReport.crsFormulasCache.arr_formulas.length;o<p;o++){var j=crsReport.crsFormulasCache.arr_formulas[o];if(!j.b_to_executed&&(j.s_app_time.indexOf(CRS_CHANGE_EXEC)!=-1||j.s_app_time=="")){if(j.s_app_time!=""){j.can_execute(f,m,true)}}}}}}},can_execute:function(o,p,l){var m=p;if(this.b_to_executed){return}if(this.s_v_compute_expr!=""){}else{if(this.arr_cur_column_ref==null){return}if(this.s_app_time.indexOf(CRS_CHANGE_EXEC)==-1){return}this.i_cur_seq=0;if(p==""){}else{var k=this.arr_cur_column_ref.indexOf(p);if(!l){o=crsReport.crsTableIndex.get_tab_id_by_col_kid(p);if(k==-1){p=crsReport.crsTableIndex.get_col_id_by_col_kid(p);k=this.arr_cur_column_ref.indexOf(p)}}if(k!=-1&&(this.s_workflow_time==""||this.s_workflow_time=="\u6240\u6709\u4efb\u52a1"||this.s_workflow_time==crsReport.crsFormulasCache.s_workflow)){if(this.s_fill_table=="\u672c\u62a5\u8868."+o||this.s_fill_table.indexOf("\u672c\u62a5\u8868."+m)!=-1||this.s_formulas_type=="\u9a8c\u8bc1\u516c\u5f0f"){this.i_cur_seq=crsReport.crsFormulasCache.i_display_seq}if(!crsReport.crsFormulasCache.b_for_delete||this.arr_fill_expr!=null&&this.arr_fill_expr.indexOf(o)!=-1){var i=crsReport.crsFormulasCache.i_display_seq;crsReport.crsFormulasCache.i_display_seq=this.i_cur_seq;this.set_to_executed(true);crsReport.crsFormulasCache.i_display_seq=i}else{if(this.arr_fill_expr!=null){for(var n=0,j=this.arr_fill_expr.length/this.i_fill_step;n<j;n++){if(this.arr_fill_expr[n*this.i_fill_step+4]==p&&(this.arr_fill_expr[n*this.i_fill_step+5]=="\u5339\u914d"||this.arr_fill_expr[n*this.i_fill_step+5]=="<>"||this.arr_fill_expr[n*this.i_fill_step+5]=="<"||this.arr_fill_expr[n*this.i_fill_step+5]=="<="||this.arr_fill_expr[n*this.i_fill_step+5]==">="||this.arr_fill_expr[n*this.i_fill_step+5]==">")&&!crsReport.crsFormulasCache.b_for_delete&&(this.s_workflow_time==""||this.s_workflow_time=="\u6240\u6709\u4efb\u52a1"||this.s_workflow_time==crsReport.crsFormulasCache.s_workflow)){this.i_cur_seq=crsReport.crsFormulasCache.i_display_seq;this.set_to_executed(true);break}}}}}}}},get_fill_type:function(j,f){var k="\u586b\u5165\u503c";if(this.arr_fill_expr!=null){for(var i=0,g=this.arr_fill_expr.length/this.i_fill_step;i<g;i++){if(this.arr_fill_expr[i*this.i_fill_step+1]==j&&this.arr_fill_expr[i*this.i_fill_step+2]==f){k=this.arr_fill_expr[i*this.i_fill_step+5];break}}}if(k==""){if(this.arr_merged_formulas_index!=null){for(var i=0,g=this.arr_merged_formulas_index.length,h=crsReport.crsFormulasCache.arr_formulas.length;i<g;i++){if(this.arr_merged_formulas_index[i]<h){k=crsReport.crsFormulasCache.arr_formulas[this.arr_merged_formulas_index[i]].get_fill_type(j,f);if(k!=""){break}}}}}return k},has_fill:function(){var b=false;if(this.s_v_compute_expr!=""){b=true}else{if(this.arr_fill_expr!=null){if(this.arr_fill_expr.indexOf("\u586b\u5165\u503c")!=-1){b=true}}}return b}};function TCRSParseCache(c,d){this.repId=d;this.crsDataSet=c;TCRSDataRecord.call(this,this.crsDataSet,"crscell.crs_parsecache","id,formulasid,cur_table_ref_list,cur_column_ref_list,column_ref_back_list,column_ref_list,fill_expr_list,_sql,_sql2,be_merged,be_hasif,be_hasmatch,recursive_cond_expr,recursive_expr,column_ref_back,cond_sql,db_label,merged_formulas_index_list","repid='"+this.repId+"'","id")}TCRSParseCache.prototype=new TCRSDataRecord();function TCRSFormulasCache(c,d){this.repId=d;this.crsDataSet=c;TCRSDataRecord.call(this,this.crsDataSet,"crscell.crs_formulas","id,label,formulastype,workflowtime,apptime,isdistinct,tablelist,table_link,condition_expr,order_expr,fill_expr,position,funname,fetch_end","repid='"+this.repId+"'","position");this.b_is_locked=false;this.s_exec_time="";this.s_workflow="";this.i_sheet_idx=0;this.s_ref_cell="";this.i_display_seq=0;this.s_exec_formulas="";this.b_for_validate=false;this.b_for_delete=false;this.b_for_pivot=false;this.arr_formulas=null;this.obj_crsParseCache=null;this.s_info="";this.s_temp_table_list=""}TCRSFormulasCache.prototype=new TCRSDataRecord();TCRSFormulasCache.prototype.init_formulas=function(){arr_tab_id=null;arr_cur_tab_name=null;if(this.arr_formulas!=null){return}if(!this.isEmpty()){if(this.obj_crsParseCache==null){this.obj_crsParseCache=new TCRSParseCache(this.crsDataSet,this.repId);this.obj_crsParseCache.loadData("#tablecrs_parsecache")}this.arr_formulas=[];var l=this.first();var p=0;while(!this.EOF()){var o=new TCRSFormulas(l.label,l.formulastype,l.workflowtime,l.apptime,l.isdistinct,l.isrecusive,l.funname,l.fetch_end);this.arr_formulas.push(o);var k=this.obj_crsParseCache.search("formulasid",l.id);if(k!=null){o.s_db_name=k.db_label;if(k.cur_table_ref_list!=""){o.arr_cur_table_ref=HandleMemoStr(k.cur_table_ref_list,false).split(",")}if(k.cur_column_ref_list!=""){o.arr_cur_column_ref=HandleMemoStr(k.cur_column_ref_list,false).split(",")}if(k.column_ref_back_list!=""){o.s_column_ref_back=HandleMemoStr(k.column_ref_back_list,false);o.arr_column_ref_back=o.s_column_ref_back.split(",");o.s_column_ref_back=o.s_column_ref_back.replaceAll(","," ")}if(k.column_ref_list!=""){o.arr_column_ref=HandleMemoStr(k.column_ref_list,false).replaceAll('"',"").split(",")}var m=HandleMemoStr(k.fill_expr_list,false);if(m!=""){if(l.formulastype!="\u53d6\u6570\u516c\u5f0f"){o.arr_fill_expr=m.split(",")}else{o.arr_fill_expr=[];var f=m.split(",");for(var p=0,i=f.length,n=0,m="";p<i;p++){if(p>0&&f[p]=="\u672c\u62a5\u8868"){o.arr_fill_expr.push(m);m="";n=0}if(n<6){o.arr_fill_expr.push(f[p]);n++}else{m+=f[p]}}o.arr_fill_expr.push(m)}}if(k.be_merged=="Y"){o.b_merged=true}if(k.be_hasif=="Y"){o.b_hasif=true}if(k.be_hasmatch=="Y"){o.b_has_match=true}if(k.merged_formulas_index_list!=""){o.arr_merged_formulas_index=HandleMemoStr(k.merged_formulas_index_list,false).split(",")}o.b_parsed=true}o.Init(HandleMemoStr(l.tablelist,false),HandleMemoStr(l.table_link,false),HandleMemoStr(l.condition_expr,false),HandleMemoStr(l.compute_expr,false),HandleMemoStr(l.target_expr,false),HandleMemoStr(l.order_expr,false),HandleMemoStr(l.fill_table,false),HandleMemoStr(l.fill_expr,false));if(l.formulastype=="\u9a8c\u8bc1\u516c\u5f0f"){o.s_input_hint_caption=HandleMemoStr(l.order_expr,false);o.s_input_hint_content=HandleMemoStr(l.fill_expr,false);o.s_error_hint_content=HandleMemoStr(l.fill_vexpr,false)}o.i_item_index=p++;l=this.next()}}};TCRSFormulasCache.prototype.execute_formulas=function(r,p,q,l,m,j,o,k,n){if(this.b_is_locked){}if(r==""){r=crsReport.s_begin_task}this.s_workflow=r;this.s_exec_time=p;this.i_sheet_idx=q;this.s_ref_cell=l;this.i_display_seq=m;this.s_exec_formulas=j;this.b_for_validate=o;this.b_for_delete=k;this.b_for_pivot=n;this.b_is_locked=true;this.begin_execute();this.execute();this.b_is_locked=false};TCRSFormulasCache.prototype.begin_execute=function(){this.loadData("#tablecrs_formulas");this.init_formulas();var h=null;if(this.s_ref_cell!=""){h=this.s_ref_cell.split(",")}if(this.arr_formulas!=null){for(var l=0,i=this.arr_formulas.length;l<i;l++){if(this.arr_formulas[l].b_to_executed){continue}if(((this.arr_formulas[l].s_app_time.indexOf(this.s_exec_time)!=-1&&(this.s_exec_time!=CRS_MANUL_EXEC||this.s_exec_time==CRS_MANUL_EXEC&&(this.s_exec_formulas!=""&&this.s_exec_formulas.indexOf(this.arr_formulas[l].s_label+",")!=-1||this.s_exec_formulas==this.arr_formulas[l].s_fun_name))||this.b_for_validate)&&(this.arr_formulas[l].s_workflow_time==""||this.arr_formulas[l].s_workflow_time=="\u6240\u6709\u4efb\u52a1"||this.arr_formulas[l].s_workflow_time==this.s_workflow)&&(this.b_for_validate&&this.arr_formulas[l].s_formulas_type=="\u9a8c\u8bc1\u516c\u5f0f"||!this.b_for_validate&&this.arr_formulas[l].s_formulas_type!="\u9a8c\u8bc1\u516c\u5f0f"))||this.b_for_pivot&&this.s_exec_formulas==this.arr_formulas[l].s_label){if(this.s_exec_time==CRS_CHANGE_EXEC){if(h!=null){for(var m=0,n=h.length;m<n;m++){var j="";this.arr_formulas[l].can_execute(j,h[m],false)}}else{var j="",k="";this.arr_formulas[l].can_execute(j,k,false)}}else{this.arr_formulas[l].set_to_executed(true)}}}}};TCRSFormulasCache.prototype.execute=function(){var aa="",W="",M="",Q="",ae="",X="",ai="",V="",al="",Z="",S="";var j=[],p=null;if(this.arr_formulas!=null){for(var Y=0,T=this.arr_formulas.length;Y<T;Y++){if(this.arr_formulas[Y].b_merged&&!this.b_for_pivot){continue}if(this.arr_formulas[Y].b_to_executed){if(this.arr_formulas[Y].b_do_match){this.arr_formulas[Y].b_do_match=false}var ad={idx:Y,f_type:this.arr_formulas[Y].s_formulas_type,r_cond_expr:this.arr_formulas[Y].s_recursive_cond_expr,seq:this.arr_formulas[Y].i_cur_seq,rep:[],app:[]};ai="";X="";if(this.arr_formulas[Y].arr_fill_expr!=null){for(var i=0,ab=this.arr_formulas[Y].arr_fill_expr.length/this.arr_formulas[Y].i_fill_step;i<ab;i++){var O=this.arr_formulas[Y].arr_fill_expr[i*this.arr_formulas[Y].i_fill_step+5];if(O=="\u5339\u914d"||O=="<>"||O=="<"||O=="<="||O==">="||O==">"){for(var K=0;K<Y;K++){if(this.arr_formulas[K].b_to_executed){if(this.arr_formulas[K].arr_fill_expr!=null){for(var ak=0,ac=this.arr_formulas[K].arr_fill_expr.length/this.arr_formulas[K].i_fill_step;ak<ac;ak++){var ag=this.arr_formulas[K].arr_fill_expr[ak*this.arr_formulas[K].i_fill_step+5];if(ag=="\u586b\u5165\u503c"||(this.s_exec_time==CRS_CHANGE_EXEC||this.s_exec_time==CRS_MANUL_EXEC)&&(ag=="\u6784\u9020\u4e0b\u62c9\u5217\u8868"||ag=="\u6784\u9020\u4e0b\u62c9\u5217\u8868\uff08\u5141\u8bb8\u5176\u4ed6\u503c\uff09")){if(this.arr_formulas[Y].arr_fill_expr[i*this.arr_formulas[Y].i_fill_step+3]==this.arr_formulas[K].arr_fill_expr[ak*this.arr_formulas[K].i_fill_step+3]&&this.arr_formulas[Y].arr_fill_expr[i*this.arr_formulas[Y].i_fill_step+4]==this.arr_formulas[K].arr_fill_expr[ak*this.arr_formulas[K].i_fill_step+4]){this.arr_formulas[Y].i_match_value_fill_formulas_index=K;this.arr_formulas[Y].b_do_match=true;break}}}if(ak<ac){break}}}}if(K>=Y){var ah=this.arr_formulas[Y].arr_fill_expr[i*this.arr_formulas[Y].i_fill_step+1];var af=this.arr_formulas[Y].arr_fill_expr[i*this.arr_formulas[Y].i_fill_step+2];if(this.b_for_pivot){var s=HandleMemoStr(crsReport.crsTableIndex.get_cell_value(ah,af,this.i_display_seq,false),false);ad.rep.push("@"+ah+CRSLimiter+af);ad.rep.push(s);this.arr_formulas[Y].b_do_match=true}else{if(this.arr_formulas[Y].i_cur_seq>0){var s=HandleMemoStr(crsReport.crsTableIndex.get_cell_value(ah,af,this.i_display_seq,false));ad.rep.push("@"+ah+CRSLimiter+af);ad.rep.push(s);this.arr_formulas[Y].b_do_match=true}else{var s=crsReport.crsTableIndex.get_cur_tab_name(this.arr_formulas[Y].arr_fill_expr[i*this.arr_formulas[Y].i_fill_step+3]);if(ae.indexOf(s)==-1){ae+=s+","}if(crsReport.crsTableIndex.get_tab_type_by_id(this.arr_formulas[Y].arr_fill_expr[i*this.arr_formulas[Y].i_fill_step+3])!="\u4ea4\u53c9\u8868"){if(X==""||X==s){if(ai!=""){ai+=","}ai+=s+".col"+this.arr_formulas[Y].arr_fill_expr[i*this.arr_formulas[Y].i_fill_step+4]+" as `"+ah+CRSLimiter+af+"`";X=s}}}}}}else{if(O=="\u6784\u9020\u4e0b\u62c9\u5217\u8868"||O=="\u6784\u9020\u4e0b\u62c9\u5217\u8868\uff08\u5141\u8bb8\u5176\u4ed6\u503c\uff09"){crsReport.crsTableIndex.clear_values_on_list(this.arr_formulas[Y].arr_fill_expr[i*this.arr_formulas[Y].i_fill_step+1],this.arr_formulas[Y].arr_fill_expr[i*this.arr_formulas[Y].i_fill_step+2],this.arr_formulas[Y].i_cur_seq)}}}if(X!=""){if(crsReport.ListKey!=""){var R=crsReport.ListKey.indexOf(".");var aj=crsReport.ListKey.indexOf(".",R+1);var L=crsReport.ListKey.substr(R+1,aj-R-1);this.arr_formulas[Y].s_dump_sql="select "+ai+" from "+X+" where displayseq="+L+" order by displayseq"}else{this.arr_formulas[Y].s_dump_sql="select "+ai+" from "+X+" order by displayseq"}}if(this.arr_formulas[Y].b_hasif&&this.arr_formulas[Y].i_cur_seq>0){if(this.arr_formulas[Y].arr_cur_column_ref!=null&&this.arr_formulas[Y].arr_cur_column_ref.length>0){var L=crsReport.crsTableIndex.get_cur_tab_name(this.arr_formulas[Y].arr_cur_table_ref[0]);ad.app.push(L+".displayseq='"+this.arr_formulas[Y].i_cur_seq+"'")}}}if(this.arr_formulas[Y].arr_cur_column_ref!=null){for(var i=0,ab=this.arr_formulas[Y].arr_cur_column_ref.length;i<ab;i++){var ah=crsReport.crsTableIndex.get_cur_tab_name(this.arr_formulas[Y].arr_cur_table_ref[i]);var L="%%"+ah+".col"+this.arr_formulas[Y].arr_cur_column_ref[i]+"%%";if(W.indexOf(L)!=-1){s=HandleMemoStr(crsReport.crsTableIndex.get_cell_value(this.arr_formulas[Y].arr_cur_table_ref[i],this.arr_formulas[Y].arr_cur_column_ref[i],true),false);ad.rep.push(L);ad.rep.push("'%%"+s+"%%'")}L="%%"+ah+".col"+this.arr_formulas[Y].arr_cur_column_ref[i];if(W.indexOf(L)!=-1){s=HandleMemoStr(crsReport.crsTableIndex.get_cell_value(this.arr_formulas[Y].arr_cur_table_ref[i],this.arr_formulas[Y].arr_cur_column_ref[i],true),false);ad.rep.push(L);ad.rep.push("'%%"+s+"%%'")}L=ah+".col"+this.arr_formulas[Y].arr_cur_column_ref[i]+"%%";if(W.indexOf(L)!=-1){s=HandleMemoStr(crsReport.crsTableIndex.get_cell_value(this.arr_formulas[Y].arr_cur_table_ref[i],this.arr_formulas[Y].arr_cur_column_ref[i],true),false);ad.rep.push(L);ad.rep.push("'%%"+s+"%%'")}}}if(this.arr_formulas[Y].s_formulas_type=="\u81ea\u5b9a\u4e49\u516c\u5f0f"){}else{if(this.arr_formulas[Y].s_dump_sql!=""){ad.dump_sql=this.arr_formulas[Y].s_dump_sql}j.push(Y);if(this.arr_formulas[Y].s_column_ref_back!=""){if(M!=""){M+="@"}M+=Y+"@"+this.arr_formulas[Y].s_column_ref_back;if(this.arr_formulas[Y].s_cond_sql!=""){Q+=Y+"_"+this.arr_formulas[Y].i_cur_seq+";"+this.arr_formulas[Y].s_cond_sql+";"}}}V=this.arr_formulas[Y].s_db_name;if(p==null){p=[]}p.push(ad)}}if(p!=null){var N=[],P=[];for(Y=0;Y<T;Y++){if(!this.arr_formulas[Y].b_to_executed){continue}if(this.arr_formulas[Y].arr_cur_column_ref!=null){for(var i=0,ab=this.arr_formulas[Y].arr_cur_column_ref.length;i<ab;i++){if(al==""||al.indexOf("a"+this.arr_formulas[Y].arr_cur_table_ref[i]+"c")==-1){var L=crsReport.crsTableIndex.get_cur_tab_name(this.arr_formulas[Y].arr_cur_table_ref[i]);if(al!=""){al+=","}al+=L}if(this.arr_formulas[Y].s_formulas_type=="\u9a8c\u8bc1\u516c\u5f0f"){P.push(this.arr_formulas[Y].arr_cur_table_ref[i]);P.push(this.arr_formulas[Y].arr_cur_column_ref[i]);P.push(this.arr_formulas[Y].i_cur_seq)}}}if(this.arr_formulas[Y].arr_fill_expr!=null){for(var i=0,ab=this.arr_formulas[Y].arr_fill_expr.length/this.arr_formulas[Y].i_fill_step;i<ab;i++){if(this.arr_formulas[Y].arr_fill_expr[i*this.arr_formulas[Y].i_fill_step+5]=="\u586b\u5165\u503c"){if(Z!=""){Z+=","}Z+=this.arr_formulas[Y].arr_fill_expr[i*this.arr_formulas[Y].i_fill_step+1]+CRSLimiter+this.arr_formulas[Y].arr_fill_expr[i*this.arr_formulas[Y].i_fill_step+2]+","+this.arr_formulas[Y].arr_fill_expr[i*this.arr_formulas[Y].i_fill_step+3]+","+this.arr_formulas[Y].arr_fill_expr[i*this.arr_formulas[Y].i_fill_step+4];if(this.arr_formulas[Y].b_do_match){N.push(this.arr_formulas[Y].arr_fill_expr[i*this.arr_formulas[Y].i_fill_step+1]);N.push(this.arr_formulas[Y].arr_fill_expr[i*this.arr_formulas[Y].i_fill_step+2]);N.push("-"+this.arr_formulas[Y].i_cur_seq)}else{if(this.arr_formulas[Y].b_has_match){if(this.arr_formulas[Y].i_match_value_fill_formulas_index>=0){N.push(this.arr_formulas[Y].arr_fill_expr[i*this.arr_formulas[Y].i_fill_step+1]);N.push(this.arr_formulas[Y].arr_fill_expr[i*this.arr_formulas[Y].i_fill_step+2]);N.push("-"+this.arr_formulas[Y].i_cur_seq)}else{N.push(this.arr_formulas[Y].arr_fill_expr[i*this.arr_formulas[Y].i_fill_step+1]);N.push(this.arr_formulas[Y].arr_fill_expr[i*this.arr_formulas[Y].i_fill_step+2]);N.push("-0")}}else{var R=-1;if(this.arr_formulas[Y].s_condition_expr!=""){var U=crsReport.crsTableIndex.get_col_kid_by_id(this.arr_formulas[Y].arr_fill_expr[i*this.arr_formulas[Y].i_fill_step+3],this.arr_formulas[Y].arr_fill_expr[i*this.arr_formulas[Y].i_fill_step+4]);R=this.arr_formulas[Y].s_condition_expr.indexOf("\u672c\u62a5\u8868."+U)}if(R==-1){N.push(this.arr_formulas[Y].arr_fill_expr[i*this.arr_formulas[Y].i_fill_step+1]);N.push(this.arr_formulas[Y].arr_fill_expr[i*this.arr_formulas[Y].i_fill_step+2]);N.push("0")}}}}}}}if(N.length>0&&!this.b_for_pivot){if(this.s_exec_time!=CRS_WRITE_EXEC){crsReport.crsTableIndex.clear_data_item(N)}if(al!=""){S=crsReport.crsTableIndex.create_cur_table_data(this.s_exec_time==CRS_DELETE_EXEC)}}else{if(al!=""){S=crsReport.crsTableIndex.create_cur_table_data(this.s_exec_time==CRS_DELETE_EXEC)}}if(P.length>0&&!this.b_for_pivot){crsReport.crsTableIndex.reset_cell_color(P)}if(this.b_for_pivot){crsReport.crsDataSet.exec_sql_list(V,p,1,aa,al,Z,M,Q,window.parent.show_pivot_datas,crsReport,j,this.s_temp_table_list,S)}else{crsReport.crsDataSet.exec_sql_list(V,p,0,aa,al,Z,M,Q,crsReport.fill_values,crsReport,j,this.s_temp_table_list,S)}}}};TCRSFormulasCache.prototype.end_execute=function(){if(this.arr_formulas!=null){for(var c=0,d=this.arr_formulas.length;c<d;c++){this.arr_formulas[c].b_to_executed=false;if(this.arr_formulas[c].s_dump_sql!=""&&this.arr_formulas[c].s_formulas_type!="\u9a8c\u8bc1\u516c\u5f0f"){this.arr_formulas[c].s_dump_sql=""}}}};TCRSFormulasCache.prototype.get_fill_type=function(d,e,f){return this.arr_formulas[d].get_fill_type(e,f)};TCRSFormulasCache.prototype.can_pivot=function(h){var f={b_can_pivot:false};if(!this.isEmpty()){var g=this.first();while(!this.EOF()){var e=HandleMemoStr(g.fill_expr,false);if(e!=""){if(e.indexOf("(\u586b\u5165\u503c) \u672c\u62a5\u8868."+h)!=-1&&(e.indexOf("\u5408\u8ba1(")!=-1||e.indexOf("\u8ba1\u6570(")!=-1||e.indexOf("\u5747\u503c(")!=-1||e.indexOf("\u6700\u5927\u503c(")!=-1||e.indexOf("\u6700\u5c0f\u503c(")!=-1||e.indexOf("\u6700\u665a(")!=-1||e.indexOf("\u6700\u65e9(")!=-1)){f.b_can_pivot=true;f.s_func=g.label;break}}g=this.next()}}return f};TCRSFormulasCache.prototype.has_manu_exec_func=function(){var f=false;if(!this.isEmpty()){var d=this.first();while(!this.EOF()){var e=HandleMemoStr(d.apptime,false);if(e.indexOf(CRS_MANUL_EXEC)!=-1){f=true;break}d=this.next()}}return f};
