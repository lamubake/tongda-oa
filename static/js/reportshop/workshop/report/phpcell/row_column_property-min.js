function TCRSRowProperty(o,l,k,n,q,r,p){this.i_prev_display_seq=l;this.i_display_seq=1;this.obj_col=o;this.obj_col_schema=null;this.s_userid=n;this.s_organid=k;this.s_writetime=q;this.s_title=r;this.s_memo=p;this.b_is_seq_updated=false;this.s_val="";this.arr_col_list=[];this.arr_val_list=[];this.arr_val_pro_list=[];for(var j=0,m=o.rows.length;j<m;j++){this.arr_col_list.push("col"+o.rows[j].id);this.arr_val_list.push("");this.arr_val_pro_list.push("")}}TCRSRowProperty.prototype={constructor:TCRSRowProperty,init:function(){this.b_is_seq_updated=false;this.s_val="";if(this.obj_col_schema==null){this.obj_col_schema=crsReport.crsTableIndex.getAColSchema(this.obj_col.rows[0].kid)}},calc_display_seq:function(j,i,f,h){if(this.b_is_seq_updated){return}var g=rectNameToIndex(j);if(i=="\u4e0d\u6269\u5c55"||i=="\u6309\u884c\u5411\u4e0b"){this.i_display_seq=(h-g[0].y)/(g[1].y-g[0].y+1)+1}else{this.i_display_seq=(f-g[0].x)/(g[1].x-g[0].x+1)+1}if(!this.b_is_seq_updated){this.b_is_seq_updated=true}if(this.i_prev_display_seq!=0&&this.i_prev_display_seq!=this.i_display_seq){if(this.s_val!=""){this.s_val+=","}this.s_val+="displayseq='"+this.i_display_seq+"'"}this.i_prev_display_seq=this.i_display_seq},add_col_value:function(g,h,e){var f=this.arr_col_list.indexOf(g);if(f!=-1){this.arr_val_list[f]=h;if(e){this.arr_val_pro_list[f]="Y"}}},update_col_value:function(c,d){if(d!=""){d=d.replaceAll("'","#005C`'");d=d.replaceAll(";",CRSSep)}if(this.s_val!=""){this.s_val+=","}if(d=="null"){this.s_val+=c+"=null"}else{this.s_val+=c+"='"+d+"'"}},get_delimited_text:function(){var f="";for(var d=0,e=this.arr_val_list.length;d<e;d++){if(d>0){f+=","}if(typeof this.arr_val_list[d]=="string"){f+="'"+this.arr_val_list[d].replaceAll("'","#005C`'").replaceAll(";",CRSSep)+"'"}else{f+="'"+this.arr_val_list[d]+"'"}}return f},is_blank:function(){var f=false;for(var d=0,e=this.arr_val_list.length;d<e;d++){if(this.arr_val_list[d]!=""&&this.arr_val_list[d]!="null"&&this.arr_val_list[d]!="0"&&(this.arr_val_pro_list[d]==""||this.arr_val_pro_list[d]==undefined)){break}}if(d>=e){f=true}return f},set_write_info:function(i,h,j,f,g){if(this.s_organid!=i){this.update_col_value("organid",i);this.s_organid=i}if(this.s_userid!=h){this.update_col_value("userid",h);this.s_userid=h}if(this.s_writetime!=j){this.update_col_value("writetime",j);this.s_writetime=j}if(this.s_title!=f){this.update_col_value("title",f);this.s_title=f}if(this.s_memo!=g){this.update_col_value("memo",g);this.s_memo=g}}};function TCRSTableProperty(){this.s_err_info="";this.arr_key_list=null;this.arr_must_list=null;this.arr_only_list=null;this.arr_val_list=null}TCRSTableProperty.prototype={constructor:TCRSTableProperty,add_key_col:function(b){if(this.arr_key_list==null){this.arr_key_list=[]}this.arr_key_list.push(b)},add_must_col:function(b){if(this.arr_must_list==null){this.arr_must_list=[]}this.arr_must_list.push(b)},add_only_col:function(b){if(this.arr_only_list==null){this.arr_only_list=[]}this.arr_only_list.push(b)},add_onrepeat_col:function(b){if(this.arr_norepeat_list==null){this.arr_norepeat_list=[]}this.arr_norepeat_list.push(b)},add_row:function(b){if(this.arr_val_list==null){this.arr_val_list=[]}this.arr_val_list.push(b)},do_check:function(F){var C=true;this.s_err_info="";var A=crsReport.crsTableIndex.rows[F];if(A.tabletype=="\u4e3b\u8868"||A.tabletype=="\u4ea4\u53c9\u8868"){if(this.arr_val_list==null){this.s_err_info+="\u3010"+A.label+"\u3011\u672a\u586b\u6570\u636e\uff01\n";C=false;return C}else{if(this.arr_val_list.length>1){this.s_err_info+="\u3010"+A.label+"\u3011\u542b\u591a\u6761\u6570\u636e\uff01\n";C=false;return C}}}if(this.arr_key_list!=null||this.arr_must_list!=null||this.arr_only_list!=null){if(this.arr_val_list!=null){var t=null,j=null;for(var z=0,x=this.arr_val_list.length;z<x;z++){var v=this.arr_val_list[z];if(!v.is_blank()){if(this.arr_must_list!=null){for(var B=0,D=this.arr_must_list.length;B<D;B++){var w=this.arr_must_list[B];var s=v.arr_col_list.indexOf("col"+w.id);if((v.arr_val_list[s]==""||v.arr_val_list[s]=="null")&&!crsReport.crsTableIndex.is_invalid(w.kid,v.i_display_seq)){this.s_err_info+="\u3010"+A.label+"\u3011\u7b2c\u3010"+v.i_display_seq+"\u3011\u884c\u6216\u5217\u4e4b\u5fc5\u586b\u9879\u3010"+w.columnlabel+"\u3011\uff0c\u672a\u586b \uff01\n"}}}if(this.arr_key_list!=null){var y="",i="",u="";for(var B=0,D=this.arr_key_list.length;B<D;B++){var w=this.arr_key_list[B];if(u!=""){u+=","}u+=w.columnlabel;var s=v.arr_col_list.indexOf("col"+w.id);if(!crsReport.crsTableIndex.is_invalid(w.kid,v.i_display_seq)){if(y!=""){y+=" and "}if(v.arr_val_list[s]!="null"){i+=v.arr_val_list[s]+",";y+=v.arr_col_list[s]+"='"+v.arr_val_list[s]+"'"}else{y+=v.arr_col_list[s]+" is null"}}}if(t==null||t.indexOf(i)==-1){if(crsReport.crsDataSet.is_exist_key(A.id,y,crsReport.userId,crsReport.writeTime)){this.s_err_info+="\u3010"+A.label+"\u3011\u7b2c\u3010"+v.i_display_seq+"\u3011\u884c\u6216\u5217\u4e4b\u4e3b\u952e\u3010"+u+"\u3011\u503c\u4e3a\u3010"+i+"\u3011\u5df2\u5b58\u5728\uff0c\u4e0d\u5141\u8bb8\u518d\u6b21\u586b\u5199 \uff01\n"}}if(t!=null&&t.indexOf(i)!=-1){this.s_err_info+="\u3010"+A.label+"\u3011\u7b2c\u3010"+v.i_display_seq+"\u3011\u884c\u6216\u5217\u4e4b\u4e3b\u952e\u3010"+u+"\u3011\u503c\u4e3a\u3010"+i+"\u3011\uff0c\u91cd\u590d\u586b\u5199 \uff01\n"}else{if(t==null){t=[]}t.push(i)}}if(this.arr_only_list!=null){var i="",E="";for(var B=0,D=this.arr_only_list.length;B<D;B++){var w=this.arr_only_list[B];if(E!=""){E+=","}E+=w.columnlabel;var s=v.arr_col_list.indexOf("col"+w.id);if(!crsReport.crsTableIndex.is_invalid(w.kid,v.i_display_seq)){if(v.arr_val_list[s]!="null"){i+=v.arr_val_list[s]+","}}}if(j!=null&&j.indexOf(i)!=-1){this.s_err_info+="\u3010"+A.label+"\u3011\u7b2c\u3010"+v.i_display_seq+"\u3011\u884c\u6216\u5217\u4e4b\u4e0d\u91cd\u590d\u9879\u3010"+E+"\u3011\u503c\u4e3a\u3010"+i+"\u3011\uff0c\u91cd\u590d\u586b\u5199 \uff01\n"}else{if(j==null){j=[]}j.push(i)}}}}}}if(this.s_err_info!=""){C=false}return C},init:function(){this.arr_val_list=null}};
