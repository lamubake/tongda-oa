function TCRSDetailPriv(f,d,e){this.crsDataSet=f;this.repId=d;if(e){TCRSDataRecord.call(this,this.crsDataSet,"crscell.crs_detailreadpriv","organid,roleid,columnlist,afilter","reportid='"+d+"'","");this.loadData("#tablecrs_detailreadpriv")}else{TCRSDataRecord.call(this,this.crsDataSet,"crscell.crs_detailwritepriv","organid,roleid,columnlist,vcolumnlist,afilter","reportid='"+d+"'","");this.loadData("#tablecrs_detailwritepriv")}}TCRSDetailPriv.prototype=new TCRSDataRecord();TCRSDetailPriv.prototype.getColumnList=function(E,F,B,w,z,D){var x="",u="";var J=true,I=true,s=false,G=false;if(!this.isEmpty()){B=","+B+F+",";z=","+z+w+",";var C=this.first();while(!this.EOF()){var A=HandleMemoStr(C.roleid,false);var H=HandleMemoStr(C.organid,false);if(A==E+"."||B.indexOf(","+H+",")!=-1||z.indexOf(","+A+",")!=-1||in_assign_user(H,A,crsReport.s_assign_user)){if(A==""||H==""||in_assign_role(A,z)||crsReport.crsDeptCache.is_dept_manager(E,H,A)){if(C.afilter!=""){if(crsReport.s_read_filter!=""){crsReport.s_read_filter+=" or "}crsReport.s_read_filter+=HandleMemoStr(C.avfilter,false)}if(crsReport.openMode=="read"){if(C.columnlist!=""&&C.columnlist!="--\u5b57\u6bb5\u5217\u8868--"){if(J){J=false}x+=HandleMemoStr(C.columnlist,false)+","}if(C.columnlist=="--\u5b57\u6bb5\u5217\u8868--"){if(!J){J=true}break}if(C.columnlist==""){if(J){J=false}}}else{if(!s){if(C.vcolumnlist!=""&&C.vcolumnlist!="--\u5b57\u6bb5\u5217\u8868--"){if(J){J=false}x+=HandleMemoStr(C.vcolumnlist,false)+","}if(C.vcolumnlist=="--\u5b57\u6bb5\u5217\u8868--"){if(!J){J=true}s=true}if(C.vcolumnlist==""){if(J){J=false}}}if(!G){if(C.columnlist!=""&&C.columnlist!="--\u5b57\u6bb5\u5217\u8868--"){if(I){I=false}u+=HandleMemoStr(C.columnlist,false)+","}if(C.columnlist=="--\u5b57\u6bb5\u5217\u8868--"){if(!I){I=true}G=true}if(C.columnlist==""){if(I){I=false}}}}}}else{if(is_ref_cell(C.roleid)){var y=crsReport.crsTableIndex.get_cell_value(C.roleid,1);y=crsReport.crsUserCache.get_id_list_by_name(y);var v=y.split(",");if(v.indexOf(crsReport.s_writer)!=-1){if(C.afilter!=""){if(crsReport.s_read_filter!=""){crsReport.s_read_filter+=" or "}crsReport.s_read_filter+=HandleMemoStr(C.afilter,false)}if(crsReport.openMode=="read"){if(C.columnlist!=""&&C.columnlist!="--\u5b57\u6bb5\u5217\u8868--"){if(J){J=false}x+=HandleMemoStr(C.columnlist,false)+","}if(C.columnlist=="--\u5b57\u6bb5\u5217\u8868--"){if(!J){J=true}break}if(C.columnlist==""){if(J){J=false}}}else{if(!s){if(C.vcolumnlist!=""&&C.vcolumnlist!="--\u5b57\u6bb5\u5217\u8868--"){if(J){J=false}x+=HandleMemoStr(C.vcolumnlist,false)+","}if(C.vcolumnlist=="--\u5b57\u6bb5\u5217\u8868--"){if(!J){J=true}s=true}if(C.vcolumnlist==""){if(J){J=false}}}if(!G){if(C.columnlist!=""&&C.columnlist!="--\u5b57\u6bb5\u5217\u8868--"){if(I){I=false}u+=HandleMemoStr(C.columnlist,false)+","}if(C.columnlist=="--\u5b57\u6bb5\u5217\u8868--"){if(!I){I=true}G=true}if(C.columnlist==""){if(I){I=false}}}}}}}C=this.next()}}if(I){}else{if(u!=""){var t=u.length;if(u.charAt(t-1)==","){u=u.substr(0,t-1)}crsReport.writeColList=u.split(",")}else{crsReport.writeColList=[]}}if(J){}else{if(x!=""){var t=x.length;if(x.charAt(t-1)==","){x=x.substr(0,t-1)}crsReport.readColList=x.split(",")}else{crsReport.readColList=[]}}};TCRSDetailPriv.prototype.get_role_list_by_organ=function(d){this.loadData();var c=this.search("organid",d);if(c!=null){return HandleMemoStr(c.roleid,false)}return""};
